# 2025-10-29-再次聊聊REITs的内部收益率--XIRR是个啥？

     上期（[一定要学会的方法！用IRR评估特许权益类REITs](https://mp.weixin.qq.com/s?__biz=Mzg4MzA0Mzg0MQ==&mid=2247484011&idx=1&sn=64a6f5b0c986f3233c5e17755b071802&scene=21#wechat_redirect)）我们谈论了最基本的IRR的用法，他仅能用于获取固定期限内稳定的现金流类的内部收益率计算，但我们实际投资中，像股票分红、基金分红（就是我们的REITs现在也有多次派发红利的，毕竟，我们投资REITs，多数是将它作为固定收益类资产配置的）是不定期派发的，本期我们继续谈谈不定期投入和不定期分红的投资类型怎样计算内部收益率，比如大家肯定有炒股的人，特别是短线高手，进出频繁，我们怎样计算IRR呢，因为只有计算出IRR后，才方便我们与大盘指数，比如沪深300，中证A500比较，是不是考虑买指数基金更赚钱，还不用操心？今天我们谈到另外一个计算内部收益率的计算公式：

**XIRR计算不规则现金流收益率**

一、完整实例解析

背景景描述：

        一位投资者从2025年1月开始，每月用工资结余买入某股票（如贵州茅台），每次买入金额因股价波动而不同。年中收到分红，年末可能因资金需求卖出部分股票。如何计算这种不规则现金流的年化收益率？

  （一）关键点

1\. XIRR适用性：

•  现金流时间不规则（每月不定额投入）

•  包含分红收入（中间现金流）

• 支持部分卖出（期末市值≠初始投资）

2\. 与IRR的区别：

• IRR要求现金流等间隔（如每年末），而XIRR允许自定义日期。

 （二）实例数据与计算步骤

1\. 整理现金流表格

假设投资者在2025年的操作如下：

【表格】

日期现金流（元）说明

2025/1/1\-150,000初始投入：买入100股@1500元

2025/2/5\-135600买入100股@1356元

2025/6/15+5,000收到分红（每股25元）

2025/8/20165000卖出100股@1650元

2025/12/31+180,000期末市值：100股@1800元（目前茅台市价是1467，希望年底能涨到1800笑脸）,可以计算到有30.32%的年化收益率。

注意：

• 负值表示资金流出（投资/买入），正值表示资金流入（分红/卖出）。

• 期末市值需作为最后一期现金流输入（视为“回收资金”）。

2\. Excel中输入数据

【表格】

列A（日期）列B（现金流）

2025/1/1\-150000

2025/2/5\-135600

2025/6/15+5000

2025/8/20+165000

2025/12/31+180000

3\. 输入XIRR公式

在空白单元格输入：

【excel】

\=XIRR(B2:B6, A2:A6)

结果：

年化收益率≈ 30.32%

如图所示：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/88Fkz47A2C5j24LkAialIOVYCkLtOlBnvQmWjUqwlInHo01SguASGplAnKFNdrbuxAYezeS4ia3EX8Sku0yLNCxg/640?wx_fmt=png&from=appmsg&watermark=1#imgIndex=1)

            同样我们再举茅台的例子，由于第二次购买多花了4万元钱，结果收益降猛降到10.18%，所以巴菲特说的入手时一定要有一个好价格是不会骗人的。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/88Fkz47A2C5j24LkAialIOVYCkLtOlBnv6hEkrm5KIdBDvMNquUOqVr04uzE12yc0ph4ztiaYOw4CzWFyEsNBsQA/640?wx_fmt=png&from=appmsg&watermark=1#imgIndex=2)

二、计算逻辑解析

（一）. XIRR原理：

（二）. 本例现金流时间轴：

• 第0天（1/1）：投入15万

• 第35天（2/5）：再投13.56万

• 第165天（6/15）：收入分红5000元

• 第232天（8/20）：卖出回收17万

• 第365天（12/31）：期末市值18万

（三）. 为什么期末市值要输入？

XIRR将期末市值视为“最后一次现金流”，反映投资的整体回报。若忽略期末市值，会低估收益率。

（四）.常见问题与解决

Q1：如果期末未全部卖出，如何输入市值？

• 仍需按当前市值作为最后一期现金流。例如持有100股@1800元，则输入+180,000。

Q2：分红再投资怎么办？

• 将分红作为现金流单独列出。若用分红买入新股，需新增一行负值（如-4,950买入3股@1650元，实际上股票交易最小单位要1手，100股的）。

Q3：XIRR为负值或错误？

• 检查现金流方向：至少1次投入（-）和1次回收（+）。

•确保日期格式正确（Excel中为日期类型）。

**温馨提示：** XIRR函数是统计学术语，用于返回一组不一定定期发生的现金流的内部收益率。其语法为XIRR(values, dates, \[guess\])，其中values为现金流，dates为支付日期，guess为估计值。该函数通过迭代法计算，要求至少有一个正现金流和一个负现金流，否则返回错误值。

\------

最后总结：XIRR的“万能公式”

1\. 记录每一笔现金流，我们每次进行操作时都记录下流水帐或者到期在证券APP上导出数据（日期+金额，投入为负，回收为正）。

2\. 期末市值必须输入，否则无法反映未实现收益。

3\. 公式：=XIRR(现金流范围, 日期范围)

4\. 适用场景：基金定投、股票分批买卖、房产出租+出售等。

通过这个例子，你是否掌握了XIRR的实战用法？

* * *

[一定要学会的方法！用IRR评估特许权益类REITs](https://mp.weixin.qq.com/s?__biz=Mzg4MzA0Mzg0MQ==&mid=2247484011&idx=1&sn=64a6f5b0c986f3233c5e17755b071802&scene=21#wechat_redirect)

[REITs投资最重要的什么？—阅读招募书](https://mp.weixin.qq.com/s?__biz=Mzg4MzA0Mzg0MQ==&mid=2247484000&idx=1&sn=4fc673ee30a6796503df9ec93daf9141&scene=21#wechat_redirect)

